{
	"name": "For_Testing_task",
	"properties": {
		"activities": [
			{
				"name": "Create TempReport",
				"type": "Script",
				"dependsOn": [],
				"policy": {
					"timeout": "7.00:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"linkedServiceName": {
					"referenceName": "vnxt_reporting",
					"type": "LinkedServiceReference"
				},
				"typeProperties": {
					"scripts": [
						{
							"type": "Query",
							"text": "Select P.GRSListid\n,G.GRSBucket\n,Geo.AreaName\n,Geo.RegionName\n,Geo.SubRegionName\n,Geo.SubsidiaryName\n,COUNT(1) AS TotalCount\n,0 AS ContactsSameSegmentFromLastWave\n,CAST(00.0000 AS numeric(6,4)) AS Perc_ContactsSameSegmentFromLastWave\n,0 AS ContactsDifferentSegmentFromLastWave\n,CAST(0.0000 AS numeric(5,4)) AS Perc_ContactsDifferentSegmentFromLastWave\n,0 AS NewContactInThisWave\n,CAST(0.0000 AS numeric(7,4)) AS Perc_NewContactInThisWave\n,0 AS PreviousWaveSampleCount\n,0 AS PreviousWaveFixableRejectionCount\n,0 AS DifferenceFromPreviousWave\n,CAST(0.0000 AS numeric(7,4)) AS Perc_DifferenceFromPreviousWave\n,0 AS NewContactsinCurrentWave\n,CAST(0.0000 AS numeric(5,4)) AS Perc_NewContactsinCurrentWave\n,0 AS ManagedContactsFromLastWave\n,0 AS ManagedContactsDifferenceFromLastWave\n,CAST(0.0000 AS numeric(6,4)) AS Perc_ManagedContactsDifferenceFromLastWave\n,COUNT(Case When ISNULL(P.RejectionCount,0) = 0 AND ISNULL(P.KeyContact,0) = 1 THEN 1 END) AS ManagedContactCRMKey\n,CAST(0.0000 AS numeric(5,4)) AS Perc_ManagedContactCRMKey\n,COUNT(Case When ISNULL(P.RejectionCount,0) = 0 AND ISNULL(P.ManagedContact,0) = 1 THEN 1 END) AS ManagedContactMPOR\n,CAST(0.0000 AS numeric(5,4)) AS Perc_ManagedContactMPOR\n,0 AS IntendedCompletes\n,CAST(0 AS bit) IsManagedSegment\n,COUNT(Case When ISNULL(P.RejectionCount,0) = 0 THEN 1 END) AS SampleCount\n,COUNT(Case When ISNULL(P.RejectionCount,0) !=0 THEN 1 END) AS RejectionCount\n,COUNT(Case When ISNULL(P.RejectionCount,0) !=0 AND ISNULL(P.IsFixable,0) = 1 THEN 1 END) AS FixableRejectionCount\n,COUNT(Case When ISNULL(P.RejectionCount,0) !=0 AND ISNULL(P.IsFixable,0) = 0 THEN 1 END) AS NonFixableRejectionCount\n,COUNT(Case WHEN ISNULL(P.RejectionCount,0) = 0 AND ISNULL(P.ManagedContact,0) = 1 THEN 1 END) AS ManagedSampleCount\n,COUNT(Case WHEN ISNULL(P.RejectionCount,0) = 0 AND ISNULL(P.ManagedContact,0) = 0 THEN 1 END) AS NonManagedSampleCount\n,COUNT(Case WHEN ISNULL(P.RejectionCount,0) = 0 AND ISNULL(P.ManagedContact,0) = 1 THEN 1 END) AS ManagedContact\n,CAST(0.0000 AS numeric(5,4)) AS Perc_ManagedContact\n,COUNT(Case WHEN ISNULL(P.RejectionCount,0) = 0 AND ISNULL(P.ManagedContact,0) = 0 THEN 1 END) AS NonManagedContact\n,COUNT(Case WHEN ISNULL(P.RejectionCount,0) = 0 AND ISNULL(P.ManagedAccount,0) = 1 THEN 1 END) AS ManagedAccount\n,COUNT(Case WHEN ISNULL(P.RejectionCount,0) = 0 AND ISNULL(P.ManagedAccount,0) = 0 THEN 1 END) AS NonManagedAccount\n,COUNT(Distinct Case WHEN ISNULL(P.RejectionCount,0) = 0 AND ISNULL(P.AccountNumber,'') != '' THEN P.AccountNumber END) AS Accountnumber\n,COUNT(Distinct Case WHEN ISNULL(P.RejectionCount,0) = 0 AND ISNULL(P.PartnerAccountNumber,'') != '' THEN P.PartnerAccountNumber END) AS PartnerAccountNumber\n,COUNT(Distinct Case WHEN ISNULL(P.RejectionCount,0) = 0 AND ISNULL(P.ParentAccountNumber,'') != '' THEN P.ParentAccountNumber END) AS ParentAccountNumber\n,0 AS MissingAccountNumber\n,0 AS TotalAccountNumber\n,0 AS AccountsManagedContact_1\n,0 AS AccountsManagedContact_2\n,0 AS AccountsManagedContact_3\n,0 AS AccountsNonManagedContact_1\n,0 AS AccountsNonManagedContact_2\n,0 AS AccountsNonManagedContact_3\n,CAST(0.0000 AS numeric(5,4)) AS Perc_AccountsManagedContact_1\n,CAST(0.0000 AS numeric(5,4)) AS Perc_AccountsManagedContact_2\n,CAST(0.0000 AS numeric(5,4)) AS Perc_AccountsManagedContact_3\n,CAST(0.0000 AS numeric(5,4)) AS Perc_AccountsNonManagedContact_1\n,CAST(0.0000 AS numeric(5,4)) AS Perc_AccountsNonManagedContact_2\n,CAST(0.0000 AS numeric(5,4)) AS Perc_AccountsNonManagedContact_3\n,CAST(0.0000 AS numeric(5,4)) AS ManagedContactMLAccountCoverage\n,CAST(0.0000 AS numeric(5,4)) AS DataQuality\n,CAST(0.0000 AS numeric(5,4)) AS DataQualityManagedContact\n,CAST(0.0000 AS numeric(5,4)) AS ChangeDataQualityInThisWave\n,CAST(0.0000 AS numeric(5,4)) AS ChangeDataQualityFromLastWave\n,CAST(0.0000 AS numeric(5,4)) AS Perc_ContactRecency_NoOld\n,CAST(0.0000 AS numeric(5,4)) AS QualifiedSampleFromLastWave\n----------NonFixable\n,COUNT(Case WHEN (ISNULL(P.RejectionSubTypes,'') like '%DNC Poland%' \nOR ISNULL(P.RejectionSubTypes,'') like '%DNC Germany%' \nOR ISNULL(P.RejectionSubTypes,'') like '%DNC France%' \nOR ISNULL(P.RejectionSubTypes,'') like '%DNC Canada%') AND (ISNULL(P.RejectionCount,0) !=0 AND ISNULL(P.IsFixable,0) = 0) THEN 1 END) AS DNCLocalSuppression\n,0 AS DNCPriorWaveHardBounceBack\n,COUNT(Case WHEN (ISNULL(P.RejectionSubTypes,'') like '%DNC MMDS Suppression%' \nOR ISNULL(P.RejectionSubTypes,'') like '%Retail Survey Priority Suppression%' \nOR ISNULL(P.RejectionSubTypes,'') like '%OEM Survey Priority Suppression%')  AND (ISNULL(P.RejectionCount,0) !=0 AND ISNULL(P.IsFixable,0) = 0) THEN 1 END) AS OtherSurveySuppression\n,COUNT(Case WHEN ISNULL(P.RejectionSubTypes,'') like '%Geneva Undeliverable%' AND (ISNULL(P.RejectionCount,0) !=0 AND ISNULL(P.IsFixable,0) = 0) THEN 1 END) AS DNCMDMHardSuppress\n,COUNT(Case WHEN (ISNULL(P.RejectionSubTypes,'') like '%Local Suppression%' \nOR ISNULL(P.RejectionSubTypes,'') like '%Hierarchy De-Duplication%' \nOR ISNULL(P.RejectionSubTypes,'') like '%Missing IsMaps%' \nOR ISNULL(P.RejectionSubTypes,'') like '%NMP%' \nOR ISNULL(P.RejectionSubTypes,'') like '%Partner Organization%' \nOR ISNULL(P.RejectionSubTypes,'') like '%Geography Out of Scope%' \nOR ISNULL(P.RejectionSubTypes,'') like '%Missing DetailedEngagementType%' \nOR ISNULL(P.RejectionSubTypes,'') like '%Missing SubSegment%' \nOR ISNULL(P.RejectionSubTypes,'') like '%Missing Segment%' \nOR ISNULL(P.RejectionSubTypes,'') like '%MSHK Competitor Suppression%' \nOR ISNULL(P.RejectionSubTypes,'') like '%Russia Competitor Suppression%' \nOR ISNULL(P.RejectionSubTypes,'') like '%Hard Bounce Back%' \nOR ISNULL(P.RejectionSubTypes,'') like '%FAR Clause Suppression%' \nOR ISNULL(P.RejectionSubTypes,'') like '%Prior Wave Survey DQ%' \nOR ISNULL(P.RejectionSubTypes,'') like '%Competitor Suppression%' \nOR ISNULL(P.RejectionSubTypes,'') like '%Company Wide Anti Survey Suppression%') AND (ISNULL(P.RejectionCount,0) !=0 AND ISNULL(P.IsFixable,0) = 0) THEN 1 END) AS OtherNonFixable\n,COUNT(Case WHEN ISNULL(P.RejectionSubTypes,'') like '%Global Company Suppression%' AND (ISNULL(P.RejectionCount,0) !=0 AND ISNULL(P.IsFixable,0) = 0) THEN 1 END) AS GlobalCompanySuppression\n,COUNT(Case WHEN ISNULL(P.RejectionSubTypes,'') like '%Duplicate Records%' AND (ISNULL(P.RejectionCount,0) !=0 AND ISNULL(P.IsFixable,0) = 0) THEN 1 END) AS DeDupeinSameBucket\n--------Fixable\n,COUNT(Case WHEN (ISNULL(P.RejectionSubTypes,'') like '%Survey Vendor Unsubscribe%' \nOR ISNULL(P.RejectionSubTypes,'') like '%Non-Personal Emails%' \nOR ISNULL(P.RejectionSubTypes,'') like '%Not In Managed List%' \nOR ISNULL(P.RejectionSubTypes,'') like '%Geneva Undeliverable%' \nOR ISNULL(P.RejectionSubTypes,'') like '%Dummy Emails%' \nOR ISNULL(P.RejectionSubTypes,'') like '%Contact Preference%') AND (ISNULL(P.RejectionCount,0) !=0 AND ISNULL(P.IsFixable,0) = 1) THEN 1 END) AS OtherFixable\n,COUNT(Case WHEN (ISNULL(P.RejectionSubTypes,'') like '%Missing FirstName%' \nOR ISNULL(P.RejectionSubTypes,'') like '%Missing LastName%' \nOR ISNULL(P.RejectionSubTypes,'') like '%Invalid or Missing company name%')  AND (ISNULL(P.RejectionCount,0) !=0 AND ISNULL(P.IsFixable,0) = 1) THEN 1 END) AS MissingNameCompanyFirstLast\n,COUNT(Case WHEN (ISNULL(P.RejectionSubTypes,'') like '%Missing Email%' \nOR ISNULL(P.RejectionSubTypes,'') like '%Invalid Email or Format%') AND (ISNULL(P.RejectionCount,0) !=0 AND ISNULL(P.IsFixable,0) = 1) THEN 1 END) AS InvalidMissingEmail\n,COUNT(Case WHEN (ISNULL(P.RejectionSubTypes,'') like '%Missing Country%' \nOR ISNULL(P.RejectionSubTypes,'') like '%Missing SubsidiaryName%' \nOR ISNULL(P.RejectionSubTypes,'') like '%Missing AccountManager%' \nOR ISNULL(P.RejectionSubTypes,'') like '%Missing City (NMP Only)%' \nOR ISNULL(P.RejectionSubTypes,'') like '%Missing ContactID%' \nOR ISNULL(P.RejectionSubTypes,'') like '%Missing AccountID%' \nOR ISNULL(P.RejectionSubTypes,'') like '%Missing Partner Number%' \nOR ISNULL(P.RejectionSubTypes,'') like '%Missing Postal Code (US Only)%' \nOR ISNULL(P.RejectionSubTypes,'') like '%Missing Company Street Address%') AND (ISNULL(P.RejectionCount,0) !=0 AND ISNULL(P.IsFixable,0) = 1) THEN 1 END) AS InvalidMissingFields\nINTO [vnxt_Reporting].dbo.TempReport\nfrom [vnxt_Reporting].[dbo].[Scorecard] P with(nolock)\nINNER JOIN [vnxt_Catalogues].[dbo].[Lkp_GRSList] G with(nolock)\nON P.grslistid = G.GrsListid\nINNER JOIN [vnxt_Reporting].[dbo].[SubsidiaryDetails] Geo with(nolock)\nON P.Subsidiaryid = Geo.SubsidiaryId\nWHERE 1=1\nGroup By P.GRSListid,\nG.GRSBucket,\nGeo.AreaName,\nGeo.RegionName,\nGeo.SubRegionName,\nGeo.SubsidiaryName\n\n\nselect 1 abcd"
						}
					]
				}
			}
		],
		"folder": {
			"name": "Reporting Pipeline"
		},
		"annotations": []
	}
}